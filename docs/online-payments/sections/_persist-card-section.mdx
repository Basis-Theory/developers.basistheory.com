import { Alert } from "@site/src/components/shared/Alert";

### Persist a Card

Once a card has been verified or charged, merchants can store details in the long-term for future use and enable express checkouts, repeat transactions for subscription services, recurring payments and consumption-based charges. Merchants are responsible for obtaining explicit customer consent before persisting card details, ensuring compliance with data protection regulations and fostering trust.

#### In your vault

It is highly recommended to keep a persistent tokenized version of the customer's card in your Basis Theory Tenant. These are often referred to as "Merchant Tokens", for they are agnostic tokens meant to work with any payments processor or acquirer.

To do that, we can convert the Token Intent into a Token, by calling the [Create Token API](/docs/api/tokens#create-token) and passing the `token_intent_id`.

```shell
curl "https://api.basistheory.com/tokens" \
  -H "BT-API-KEY: <PRIVATE_API_KEY>" \
  -H "Content-Type: application/json" \
  -X "POST" \
  -d '{
    "token_intent_id": "d2cbc1b4-5c3a-45a3-9ee2-392a1c475ab4"
  }'
```

This operation returns a new or existing persistent Token depending on your fingerprinting and deduplication options:

```json
{
  // highlight-next-line
  "id": "1cd9c8bf-99fd-4784-ba69-68b15b301019",
  "type": "card",
  "tenant_id": "74eca6ab-f94d-49bc-9f3c-6144eb3415ac",
  "data": {
    "number": "XXXXXXXXXXXX4200",
    // highlight-start
    "expiration_month": 1,
    "expiration_year": 2028
    // highlight-end
  },
  "enrichments": {
    "card_details": {
      "bin": "424242",
      // highlight-next-line
      "last4": "4242"
    },
    "bin_details": {
      // highlight-next-line
      "card_brand": "VISA",
      ...
    }
  },
  ...
  "fingerprint": "H46vMHviE7DmGM5yCrvo9NkootV6SXX5GrXnaYsjRoXP",
  "_extras": {
    "deduplicated": false
  }
}
```

<Alert>[Click here](/docs/api/tokens/token-intents#convert-token-intent-to-token) to learn more about the token conversion behavior.</Alert>

What you should store in your database:

- The **token identifier**, associating it with the rightful customer(s).
- The card **brand**, **expiration date** and **last four digits**, available in the [Token Intent](/docs/api/tokens/token-intents#token-intent-object) or [Token](/docs/api/tokens/#token-object) object; if you want to skip [retrieving the token](http://localhost:3000/docs/api/tokens/#get-a-token) when rendering that information to your customer.
- The **Network Transaction identifier**, returned by the processor during the initial transaction; allowing you to seamlessly charge the card with new processors or acquirers in the future and achieve the best approval rates. Refer to your current processorâ€™s documentation or support for guidance on accessing this value.

#### With the Payments Service Provider

You can also instruct the Payments Service Provider (PSP) to save card data after verification or an initial transaction, generating a reference known as a "PSP Token" that you can store. This token allows merchants to perform subsequent transactions by making direct requests to the processor, bypassing the use of the proxy entirely.

PSPs typically document this process clearly in their guides, as it aligns with their own best interests. In some cases, it is as simple as including a special flag in the initial transaction, while others may require an additional request to explicitly instruct them to create a new reference. If you have trouble finding out how to do this, don't hesitate to [reach out to our support team](https://basistheory.com/contact?how_can_we_help_=I+need+help+figuring+out+how+to+create+a+PSP+token+for+&lt;PSP+name&gt;).
