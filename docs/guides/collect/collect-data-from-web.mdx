import Tabs from "@theme/Tabs";
import TabItem from "@theme/TabItem";

import { Button } from "@site/src/components/shared/Button";
import { Alert, Alerts } from "@site/src/components/shared/Alert";

# Collect Data from Web

This guide will show you how to collect data from a web browser without touching the data. 

Key concepts in this guide:
- [Tokens](/docs/concepts/what-are-tokens)
- [Applications](/docs/api/applications)
- [JavaScript Elements](/docs/sdks/web/javascript-elements)


## Getting Started

To get started, you will need a Basis Theory account.

<Button
  href="https://portal.basistheory.com/register"
  target="_blank"
>
  Sign Up
</Button>

<Button
  href="https://portal.basistheory.com/"
  target="_blank"
  variant="secondary"
>
  Sign In
</Button>

Next you will need a [Public Application](/docs/api/applications#application-types) in order to initialize [JavaScript Elements](/docs/sdks/web/javascript-elements) for your web page.

Login to your Basis Theory account and [create a new Application](https://portal.basistheory.com/applications) with the following settings:

* Name - Collect Data from Web Guide
* Application Type - Public
* Permissions - `token:create`

<Alert>
  Save the API Key from the created Public APplication as it will be used later in this guide to initialize the form.
</Alert>

## Create a New HTML File

We are going to create a `index.html` file for the contents of this guide.

Create a new file in your preferred IDE or text editor called `index.html` or you can create the file via your terminal with the command:

```shell showLineNumbers
touch index.html
```

Open the resulting `index.html` file in an IDE or text editor of your choice.


## Install the Web SDK

We will need to install Basis Theory's [JavaScript Elements SDK](/docs/sdks/web/javascript-elements), which will render a secure iFrame for capturing the data. 

To install the SDK you can choose either our ES module or CDN hosted bundle through a `script` tag. In this guide, we will utilize the CDN hosted bundle.

```html showLineNumbers title=index.js
<!-- Including this tag will export a global/window "BasisTheory" variable -->
<html>
  <head>
    <script src="https://js.basistheory.com"></script>
  </head>
</html>
```

<Alert>
  If you are building a React application, be sure to check out our <a href="/docs/sdks/web/react-elements">React Elements SDK</a>.
</Alert>


## Initialize the Web SDK

Now we need to initialize Basis Theory JavaScript Elements. To do this, we will create an instance of `BasisTheory` with `elements: true` to dynamically loads **Elements** module.

```html showLineNumbers title=index.js
<script>
  // you can initialize it wherever it suits your workflow best
  // here we are waiting for the window to load, to make sure BasisTheory instance
  // has been injected in the window variable
  window.addEventListener('load', async () => {
    try {
      // global/window variable BasisTheory is an instance, but requires initialization
      await BasisTheory.init('test_1234567890', { elements: true });
    } catch (e) {
      // handle errors that could happen while loading elements script
    }
  });
</script>
```

<Alert>
  Be sure to replace <code>test_1234567890</code> with the Public API Key you created in the <a href="#getting-started">Getting Started</a> step.
</Alert>


## Add Your Form Components

This step will add a [Text Element](/docs/sdks/web/elements/types#text-element) component to our page.

First let's add a `div` to be the placeholder for where the Basis Theory Element will be injected:

```html showLineNumbers title=index.js
<html>
  <head>
    <script src="https://js.basistheory.com"></script>
  </head>
  <body>
    <div id="example-element">
  </body>
</html>
```

Next, we need to create a new Text Element and mount it to our `div`:

```html showLineNumbers title=index.js
<script>
  let textElement;

  window.addEventListener('load', async () => {
    await BasisTheory.init("test_1234567890", { elements: true });

    textElement = BasisTheory.createElement('text', {
      targetId: 'exampleTextElement',
      placeholder: 'Input text'
    });

    textElement.mount('#example-element'); 
  });
</script>
```

This will create a new instance of a Text Element and when mounted to your `<div>`, it will inject an iFrame that is rendered by Basis Theory. The Basis Theory SDK will hold a reference to the Text Element which enables interactions with the underlying data without direct access to the value.


## Tokenize the Text Value

Now we need to tokenize the value within the Text Element without exposing it to our web application.

We will add a submit button for submitting the form and a `<pre>` to hold the resulting token.

```html showLineNumbers title=index.js
<html>
  <head>
    <script src="https://js.basistheory.com"></script>
  </head>
  <body>
    <div id="example-element">

    <button type="button" onclick="submit()">
      Submit
    </button>

    <pre id="result"></pre>
  </body>
</html>
```

Within our JavaScript code, let's add a new submit function to tokenize the value of our Text Element.

```html showLineNumbers title=index.js
<script>
  let textElement;

  window.addEventListener('load', async () => {
    await BasisTheory.init("test_1234567890", { elements: true });

    textElement = BasisTheory.createElement('text', {
      targetId: 'exampleTextElement',
      placeholder: 'Input text'
    });

    textElement.mount('#example-element'); 
  });

  async function submit() {
    try {
      const token = await BasisTheory.tokens.create({
        type: 'token',
        data: textElement
      });

      const result = document.querySelector('#result');

      result.innerHTML = JSON.stringify(token, null, 4);
    } catch (error) {
      console.error(error);
    }
  }
</script>
```

When our form is submitted, Basis Theory's SDK will pass the value for the element reference. This will be securely submitted directly to the [Create Token Endpoint](/docs/api/tokens#create-token). The resulting token is then surfaced to the client device.

## Running the Example

Following this guide, your resulting page should look like the following:

```html showLineNumbers title=index.js
<html>
  <head>
    <script src="https://js.basistheory.com"></script>
  </head>
  <body>
    <div id="example-element"></div>

    <button type="button" onclick="submit()">
      Submit
    </button>

    <pre id="result"></pre>

    <script>
      let textElement;

      window.addEventListener('load', async () => {
        await BasisTheory.init("key_3aYBJ6NbEvyU5FN9n1Xbvw", { elements: true });

        textElement = BasisTheory.createElement('text', {
          targetId: 'exampleTextElement',
          placeholder: 'Input text'
        });

        textElement.mount('#example-element'); 
      });

      async function submit() {
        try {
          const token = await BasisTheory.tokens.create({
            type: 'token',
            data: textElement
          });

          const result = document.querySelector('#result');

          result.innerHTML = JSON.stringify(token, null, 4);
        } catch (error) {
          console.error(error);
        }
      }
    </script>
  </body>
</html>
```

To run the example, we will utilize [`http-server`](https://www.npmjs.com/package/http-server) to run our file in a local server. In the same directory as your `index.html` file, run the following command:

```shell showLineNumbers
npx http-server -o
```

A browser will open to your page running on `http://localhost:8080/`.

## Conclusion

You can now capture any data without your application accessing the underlying value drastically reducing compliance and regulatory scope. 

Try typing a value and clicking the submit button will securely send the data directly to Basis Theory and return you a [token](/docs/concepts/what-are-tokens). The resulting token is displayed directly on the page.


## Learn More
- [What are tokens?](/docs/concepts/what-are-tokens)
- [Customize your web form](/docs/guides/collect/customize-web-form)
- [Collect data in your web application with React Elements](/docs/sdks/web/react-elements)
- [Collect and process cards](/docs/blueprints/cards/collect-and-process-cards)